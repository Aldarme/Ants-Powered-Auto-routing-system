'''
Created on 21 avr. 2021

@author: promet
'''

import pymongo
from pickle import NONE

DBDEBUG = False

class dbExploit:
    
    DBPORT = 0
    client = NONE
    myCollec = 0
    
    bs_nameSet = {
    'La Douce': 'LaDouce',
    'Signoret': 'Signoret',
    'Schuman': 'Schuman',
    'Bruxelles': 'Bruxelles',
    'Jaurès Hôpital': 'JauresHopital',
    'Strasbourg': 'Strasbourg',
    'Colmar': 'Colmar',
    'Roseraie': 'Roseraie',
    'Marché Vosges': 'MarcheVosges',
    'Salbert': 'Salbert',
    'Rubans': 'Rubans',
    'La Dame': 'LaDame',
    'La Belle': 'LaBelle',
    'Acacias': 'Acacias',
    'Argiésans Centre': 'ArgiesansCentre',
    'Zi de Bavilliers': 'ZideBavilliers',
    "Rte d'Urcerey": 'RtedeUrcerey',
    'Route de Buc': 'RoutedeBuc',
    'Bavilliers': 'Bavilliers',
    'Pont Canal': 'PontCanal',
    'Mozart': 'Mozart',
    'Bonneff': 'Bonneff',
    'Mieg': 'Mieg',
    'Saget': 'Saget',
    'Ste Thérèse': 'SteTherese',
    "Grand' Combe": 'GrandeCombe',
    'Laurent Thierry': 'LaurentThierry',
    'Alstom Étang': 'AlstomEtang',
    "Techn' Hom Cravanche": 'TechnHomCravanche',
    'Les Perches': 'LesPerches',
    'Altkirch': 'Altkirch',
    'Sellier': 'Sellier',
    'Parant': 'Parant',
    'Cimetière Militaire': 'CimetiereMilitaire',
    'Laurencie': 'Laurencie',
    'CFA': 'CFA',
    'Bichat': 'Bichat',
    'Hauts de Belfort': 'HautsdeBelfort',
    'Camus': 'Camus',
    '1er RA': 'PremiereRA',
    'Gare TGV': 'GareTGV',
    'Rte de Meroux': 'RtedeMeroux',
    'Moval': 'Moval',
    'Hôpital NFC': 'HopitalNFC',
    'Sévenans UTBM': 'SevenansUTBM',
    'Géhant': 'Gehant',
    'Châtenois': 'Chatenois',
    'Complexe Sportif': 'ComplexeSportif',
    'Châtenois Forges': 'ChatenoisForges',
    'Rte de Vourvenans': 'RtedeVourvenans',
    'Trévenans': 'Trevenans',
    'Bascule': 'Bascule',
    'Conforama': 'Conforama',
    'Rte de Bermont': 'RtedeBermont',
    'OEufs Frais': 'OeufsFrais',
    'Port de Botans': 'PortdeBotans',
    'Andelnans Prés': 'AndelnansPres',
    'Grottes': 'Grottes',
    'Éluard': 'Eluard',
    'Jacquot': 'Jacquot',
    'Bosmont': 'Bosmont',
    'Varonne': 'Varonne',
    "Techn' Hom 1 UTBM": 'Technhom1UTBM',
    'IUT': 'IUT',
    "Techn' Hom 2": 'Technhom2',
    "Techn' Hom 3": 'Technhom3',
    'Benoit Frachon': 'BenoitFrachon',
    'Méchelle': 'Mechelle',
    'Berger': 'Berger',
    "L'assise": 'Assise',
    'St Antonin': 'StAntonin',
    'Pierre Engel': 'PierreEngel',
    'Marcel Braun': 'MarcelBraun',
    'Chênois': 'Chenois',
    'Poincaré': 'Poincaré',
    'Renan': 'Renan',
    'Molière': 'Molière',
    'Hôpital': 'Hopital',
    'Mulhouse': 'Mulhouse',
    'Bohn': 'Bohn',
    'Madagascar': 'Madagascar',
    'Ferrette': 'Ferette',
    'Parmentier': 'Parmentier',
    'Courbet': 'Courbet',
    'Centre Commercial': 'CentreCommercial',
    'Romaine': 'Romaine',
    'Ballon': 'Ballon',
    'Moulin': 'Moulin',
    'Champs Cerisiers': 'ChampsCerisiers',
    'Bois Joli': 'BoisJoli',
    'Carrières': 'Carrières',
    'Gardey': 'Gardey',
    'Marseille': 'Marseille',
    'Les Forges': 'LesForges',
    'Champ de Mars': 'ChampdeMars',
    'Martinet': 'Martinet',
    'Marchegay': 'Marchegay',
    'Pont Blanc': 'PontBlanc',
    'Paquis': 'Paquis',
    'Savoureuse': 'Savoureuse',
    'Turenne': 'Turenne',
    'Nallet': 'Nallet',
    'Beurrerie': 'Beurrerie',
    "Prés d'Aumont": 'PresdeAumont',
    'Mermoz': 'Mermoz',
    'Aubépines': 'Aubepines',
    'Rosemontoise': 'Rosemontoise',
    'Route de Sermamagny': 'RoutedeSermamagny',
    'Eloie': 'Eloie',
    'Verdoyeux': 'Verdoyeux',
    'Chaume': 'Chaume',
    'Schweitzer': 'Schweitzer',
    'Cravanche Centre': 'CravancheCentre',
    'Cravanchoise': 'Cravanchoise',
    'Haut des Près': 'Hautdespres',
    'La Forêt': 'Laforet',
    'Bas du Village': 'Basduvillage',
    'Frezard': 'Frezard',
    'Pins': 'Pins',
    'Terrasses': 'Terrasses',
    'Clinique': 'Clinique',
    'Haute Miotte': 'Haute Miotte',
    'Deshaie': 'Deshaie',
    'Picard': 'Picard',
    'As de Trèfle': 'AsdeTrefle',
    'Mairie': 'Mairie',
    'Blumberg': 'Blumberg',
    '1re Armée': 'PremiereArmee',
    'Paul Bert': 'PaulBert',
    'Briand': 'Briand',
    'Miotte': 'Miotte',
    'Atria': 'Atria',
    'Clemenceau': 'Clemenceau',
    'Rabin': 'Rabin',
    'République': 'Republique',
    'Foch': 'Foch',
    'Schwob': 'Schwob',
    'Denfert Rochereau': 'DenfertRochereau',
    'Strotz': 'Strolz',
    '4 As': '4As',
    'Hatry': 'Hatry',
    'Dubail': 'Dubail',
    'Follereau': 'Follereau',
    'Guidon': 'Guidon',
    'Madrid': 'Madrid',
    'Blum': 'Blum',
    'Fg de Lyon': 'FbdeLyon',
    'Gare': 'Gare',
    'Sernam': 'Sernam',
    'Colbert': 'Colbert',
    'Multiplexe': 'Multiplexe',
    'Le Nôtre': 'LeNotre',
    'La Poste': 'LaPoste',
    'Essert': 'Essert',
    'De Gaulle': 'DeGaulle',
    'Chemin de la ferme': 'Chemindelaferme',
    'Ballinamuck': 'Ballinamuck'    
    }
    
    
    @staticmethod
    def init_connection():
        #constant port for db connection
        dbExploit.DBPORT = 27017
        
        #connection to MOngoDB
        dbExploit.client = pymongo.MongoClient('localhost', dbExploit.DBPORT)
        
        #target the working data base
        myDb = dbExploit.client.GraphBelfort
        
        #target the working collection
        dbExploit.myCollec = myDb.Optimo_meanDay_TeslaS


    @staticmethod
    def section_getData(str1, str2):
        bs1 = dbExploit.bs_nameSet[str1]
        bs2 = dbExploit.bs_nameSet[str2]
        tmp = dbExploit.myCollec.find_one( {'$or': [{'$and': [{"busStop1":bs1}, {"busStop2":bs2}]}, {'$and': [{"busStop1":bs2}, {"busStop2":bs1}]}]}  )
        return tmp
    

    @staticmethod
    def db_close():
        dbExploit.client.close()
